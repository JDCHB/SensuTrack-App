import{t as z,a as Q}from"./DAy9PkhU.js";import{i as X}from"./CHjcBrZ9.js";import{k as Y,m as k,n as Z,o as x,w as $,x as j,v as D,t as H,y as N}from"./V2kXoyKe.js";import{e as ee}from"./Nn6L6OkE.js";import{b as M,r as K}from"./BBr6DWM0.js";import{b as te}from"./DBCRKDJt.js";import{g as se}from"./D7j5owh8.js";import{_ as re}from"./C1FmrZbK.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var O;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(O||(O={}));class W extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const ne=s=>{var e,t;return s!=null&&s.androidBridge?"android":!((t=(e=s==null?void 0:s.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},ie=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},i=t.Plugins=t.Plugins||{},r=()=>e!==null?e.name:ne(s),n=()=>r()!=="web",c=a=>{const l=p.get(a);return!!(l!=null&&l.platforms.has(r())||d(a))},d=a=>{var l;return(l=t.PluginHeaders)===null||l===void 0?void 0:l.find(y=>y.name===a)},u=a=>s.console.error(a),p=new Map,w=(a,l={})=>{const y=p.get(a);if(y)return console.warn(`Capacitor plugin "${a}" already registered. Cannot register plugins twice.`),y.proxy;const b=r(),P=d(a);let o;const I=async()=>(!o&&b in l?o=typeof l[b]=="function"?o=await l[b]():o=l[b]:e!==null&&!o&&"web"in l&&(o=typeof l.web=="function"?o=await l.web():o=l.web),o),R=(f,v)=>{var g,L;if(P){const E=P==null?void 0:P.methods.find(m=>v===m.name);if(E)return E.rtype==="promise"?m=>t.nativePromise(a,v.toString(),m):(m,U)=>t.nativeCallback(a,v.toString(),m,U);if(f)return(g=f[v])===null||g===void 0?void 0:g.bind(f)}else{if(f)return(L=f[v])===null||L===void 0?void 0:L.bind(f);throw new W(`"${a}" plugin is not implemented on ${b}`,O.Unimplemented)}},h=f=>{let v;const g=(...L)=>{const E=I().then(m=>{const U=R(m,f);if(U){const T=U(...L);return v=T==null?void 0:T.remove,T}else throw new W(`"${a}.${f}()" is not implemented on ${b}`,O.Unimplemented)});return f==="addListener"&&(E.remove=async()=>v()),E};return g.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(g,"name",{value:f,writable:!1,configurable:!1}),g},C=h("addListener"),_=h("removeListener"),A=(f,v)=>{const g=C({eventName:f},v),L=async()=>{const m=await g;_({eventName:f,callbackId:m},v)},E=new Promise(m=>g.then(()=>m({remove:L})));return E.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await L()},E},S=new Proxy({},{get(f,v){switch(v){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return P?A:C;case"removeListener":return _;default:return h(v)}}});return i[a]=S,p.set(a,{name:a,proxy:S,platforms:new Set([...Object.keys(l),...P?[b]:[]])}),S};return t.convertFileSrc||(t.convertFileSrc=a=>a),t.getPlatform=r,t.handleError=u,t.isNativePlatform=n,t.isPluginAvailable=c,t.registerPlugin=w,t.Exception=W,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ae=s=>s.Capacitor=ie(s),q=ae(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),F=q.registerPlugin;class V{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),i&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,i){const r=this.listeners[e];if(!r){if(i){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}return}r.forEach(n=>n(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new q.Exception(e,O.Unimplemented)}unavailable(e="not available"){return new q.Exception(e,O.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const r=i.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const G=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),J=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class oe extends V{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[r,n]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=J(r).trim(),n=J(n).trim(),t[r]=n}),t}async setCookie(e){try{const t=G(e.key),i=G(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${r}; path=${n}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}F("CapacitorCookies",{web:()=>new oe});const ce=async s=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const r=i.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},i.onerror=r=>t(r),i.readAsDataURL(s)}),le=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(r=>r.toLocaleLowerCase()).reduce((r,n,c)=>(r[n]=s[e[c]],r),{})},de=(s,e=!0)=>s?Object.entries(s).reduce((i,r)=>{const[n,c]=r;let d,u;return Array.isArray(c)?(u="",c.forEach(p=>{d=e?encodeURIComponent(p):p,u+=`${n}=${d}&`}),u.slice(0,-1)):(d=e?encodeURIComponent(c):c,u=`${n}=${d}`),`${i}&${u}`},"").substr(1):null,ue=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),r=le(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(r.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[c,d]of Object.entries(s.data||{}))n.set(c,d);t.body=n.toString()}else if(r.includes("multipart/form-data")||s.data instanceof FormData){const n=new FormData;if(s.data instanceof FormData)s.data.forEach((d,u)=>{n.append(u,d)});else for(const d of Object.keys(s.data))n.append(d,s.data[d]);t.body=n;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(r.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class fe extends V{async request(e){const t=ue(e,e.webFetchExtra),i=de(e.params,e.shouldEncodeUrlParams),r=i?`${e.url}?${i}`:e.url,n=await fetch(r,t),c=n.headers.get("content-type")||"";let{responseType:d="text"}=n.ok?e:{};c.includes("application/json")&&(d="json");let u,p;switch(d){case"arraybuffer":case"blob":p=await n.blob(),u=await ce(p);break;case"json":u=await n.json();break;case"document":case"text":default:u=await n.text()}const w={};return n.headers.forEach((a,l)=>{w[l]=a}),{data:u,headers:w,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}F("CapacitorHttp",{web:()=>new fe});const B=F("Preferences",{web:()=>re(()=>import("./DVgzZcWb.js"),[],import.meta.url).then(s=>new s.PreferencesWeb)});var ve=z('<div class="login-screen svelte-108db26"><div class="overlay svelte-108db26"></div> <div class="login-content svelte-108db26"><div class="logo svelte-108db26"><img src="/logo.jpg" alt="" class="svelte-108db26"></div> <form class="svelte-108db26"><div class="input-group svelte-108db26"><span class="icon svelte-108db26">👤</span> <input type="text" id="correo" placeholder="Correo" required class="svelte-108db26"></div> <div class="input-group svelte-108db26"><span class="icon svelte-108db26">🔒</span> <input type="password" id="contraseña" placeholder="Contraseña" required class="svelte-108db26"></div> <button class="login-button svelte-108db26" type="submit">Iniciar Sesión</button> <div class="loader-container svelte-108db26"><div class="loader-text svelte-108db26"><span class="svelte-108db26">S</span> <span class="svelte-108db26">e</span> <span class="svelte-108db26">n</span> <span class="svelte-108db26">s</span> <span class="svelte-108db26">u</span> <span class="svelte-108db26">T</span> <span class="svelte-108db26">r</span> <span class="svelte-108db26">a</span> <span class="svelte-108db26">c</span> <span class="svelte-108db26">k</span></div></div></form> <div class="links svelte-108db26"><div class="link-item svelte-108db26"><a href="/Cambio_Clave" class="svelte-108db26">Olvidaste la contraseña?</a></div></div></div></div>');function Le(s,e){Y(e,!1);let t=D(""),i=D(""),r=D();function n(o){o&&(o.style.display="flex")}function c(o){o&&(o.style.display="none")}async function d(o){o.preventDefault();const I=document.getElementById("correo").value,R=document.getElementById("contraseña").value;try{n(k(r));const h=await fetch("https://proyectomascotas.onrender.com/login_generate_token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,password:R})}),C=await h.json();if(c(k(r)),h.ok){const{access_token:_,user_data:A}=C;if(await B.set({key:"access_token",value:_}),await B.set({key:"user_data",value:JSON.stringify(A)}),A.id_rol==3)Swal.fire({title:"Inicio de Sesión Exitoso",text:"¡Bienvenido al Sistema de Super Administrador!",icon:"success",confirmButtonText:"OK"}).then(()=>se("Super_Administrador"));else{const S=A.id_rol==2?"Ahora mismo no está disponible este Rol (Usuario) ಥ_ಥ":"Ahora mismo no está disponible este Rol (Administrador) ಥ_ಥ";Swal.fire({icon:"warning",title:"Lo sentimos",text:S}).then(async()=>{await B.clear(),window.location.href="/"})}}else{const _=(C==null?void 0:C.detail)||"Usuario o Contraseña Incorrectos!";h.status===403?Swal.fire({icon:"warning",title:"Cuenta Desactivada",text:_}):Swal.fire({icon:"error",title:"Oops...",text:_})}}catch(h){console.error("Error en la solicitud:",h.message),c(k(r)),Swal.fire({icon:"error",title:"Error",text:"Hubo un problema con el inicio de sesión. Intenta nuevamente."})}}X();var u=ve(),p=x($(u),2),w=x($(p),2),a=$(w),l=x($(a),2);K(l),j(a);var y=x(a,2),b=x($(y),2);K(b),j(y);var P=x(y,4);te(P,o=>H(r,o),()=>k(r)),j(w),N(2),j(p),j(u),M(l,()=>k(t),o=>H(t,o)),M(b,()=>k(i),o=>H(i,o)),ee("submit",w,d),Q(s,u),Z()}export{V as W,Le as _};
